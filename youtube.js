{
	let script = document.createElement('script');
	script.innerHTML = "Replayer={text:{Loop:'|&#11118;|',Crop:'|&#9205;|',Stop:'&#9205;',ButtonFrom:'A',ButtonTo:'B',PlaceHolderFrom:'From',PlaceHolderTo:'To',TooltipFromButton:'Set current position as start of repeat',TooltipToButton:'Set current position as end of repeat',TooltipLoopToCrop:'Looping; Click to Crop',TooltipCropToStop:'Cropped; Click to Normal',TooltipStopToLoop:'Normal; Click to Loop',TooltipFormat:'[ [ [ h: ] m: ] s. ] ms',TooltipFrom:'Start',TooltipTo:'End'},mode:{stop:1,loop:2,crop:3},curMode:1,format:/^\\D*(\\d*)\\D*(\\d*)\\D*(\\d*)\\D*(\\d*)\\D*$/,duration:{},setStop:function(){this.rmTimer();},setLoop:function(){this.rmTimer();if(this.player.getPlayerState()!==1||this.duration.end<=this.player.getCurrentTime()*1000||this.player.getCurrentTime()*1000<this.duration.start){if(this.player.getPlayerState()===2)this.player.playVideo();this.player.seekTo(this.duration.start/1000,!0);}this.setTimer(()=>this.setLoop());},setCrop:function(){this.rmTimer();if(this.duration.end<=this.player.getCurrentTime()*1000)this.player.seekTo(this.player.getDuration(),!0);else{if(this.player.getCurrentTime()*1000<this.duration.start)this.player.seekTo(this.duration.start/1000,!0);this.setTimer(()=>this.setCrop());}},setTimer:function(f){this.timer=setTimeout(f,this.duration.end-this.player.getCurrentTime()*1000);},setRange:function(){let s,e;s=this.getSecond($('#replayerTimerFrom'));e=this.getSecond($('#replayerTimerTo'));if(e<=0||e>(this.player.getDuration()+1)*1000)e=Math.floor(this.player.getDuration()*1000);if(s<0)s=0;if(e<s){let t=s;s=e;e=t;}if(s==this.duration.start&&e==this.duration.end)return!1;this.duration.start=s;this.duration.end=e;return!0;},setA:function(){this.duration.start=Math.floor(this.player.getCurrentTime()*1000);if(!this.duration.end||this.duration.start>this.duration.end)this.duration.end=Math.floor(this.player.getDuration()*1000);this.showRepeatRange();this.toggle(this.curMode);},setB:function(){this.duration.end=Math.floor(this.player.getCurrentTime()*1000);if(!this.duration.start||this.duration.start>this.duration.end||this.duration.start<0)this.duration.start=0;this.showRepeatRange();this.toggle(this.curMode);},showRepeatRange:function(){$('#replayerTimerFrom').value=this.msToStr(this.duration.start);$('#replayerTimerTo').value=this.msToStr(this.duration.end);},rmTimer:function(){clearTimeout(this.timer);this.timer=null;},toggle:function(mode){if(!this.player||Object.keys(this.init.state).length!=0)setTimeout(()=>this.toggle(mode),100);else if(this.player.getAdState()>0){$('video').addEventListener('durationchange',()=>{let e=$('video');if(!isNaN(e.duration)){e.removeEventListener('durationchange',arguments.callee);this.toggle(mode);}});setTimeout(()=>this.toggle(mode),(this.player.getDuration()-this.player.getCurrentTime())*1000);}else{let e=$('#replayToggle');if(mode==this.mode.loop||!mode&&this.curMode==this.mode.stop){this.curMode=this.mode.loop;this.setRange()&&this.showRepeatRange();this.setLoop();e.innerHTML=this.text.Loop;e.title=e.dataset.tooltipText=this.text.TooltipLoopToCrop;$('video').loop=!0;}else if(mode==this.mode.crop||!mode&&this.curMode==this.mode.loop){this.curMode=this.mode.crop;this.setRange()&&this.showRepeatRange();this.setCrop();e.innerHTML=this.text.Crop;e.title=e.dataset.tooltipText=this.text.TooltipCropToStop;$('video').loop=!1;}else{this.curMode=this.mode.stop;this.rmTimer();e.innerHTML=this.text.Stop;e.title=e.dataset.tooltipText=this.text.TooltipStopToLoop;$('video').loop=!1;}}},toSecond:function(v,l){if(v.constructor==String&&l==1){if(v.length>=3)return Number(v);if(v.length==2)return Number(v)*10;if(v.length==1)return Number(v)*100;}if(l<=4&&l>0)return this.toSecond(Number(v)*[60,60,1000,1][4-l],l-1);return Number(v);},getSecond:function(e){var t=e.value.match(this.format);var count=4;switch(''){case t[1]:count--;case t[2]:count--;case t[3]:count--;case t[4]:count--;}return!!count?(this.toSecond(t[1],count)+this.toSecond(t[2],count-1)+this.toSecond(t[3],count-2)+this.toSecond(t[4],count-3)):0;},msToStr:function(t){let s=[t%1000,(Math.floor(t/1000))%60,(Math.floor(t/(60*1000)))%60,(Math.floor(t/(60*60*1000)))];return(s[3]>9?(s[3]+':'):s[3]>0?('0'+s[3]+':'):'')+(s[2]>9?(s[2]+':'):s[2]>0?('0'+s[2]+':'):s[3]>0?'00:':'')+(s[1]>9?(s[1]+'.'):s[1]>0?('0'+s[1]+'.'):'00.')+(s[0]>99?s[0]:s[0]>9?'0'+s[0]:'00'+s[0]);},IndexedDB:{isOpen:!1,isReqOpen:!1,waitingFunctionList:[],openDB:function(){if(!window.indexedDB)console.log('IndexedDB is not support, no data will be saved.');else if(!this.isOpen&&!this.isReqOpen){this.dbreq=window.indexedDB.open('YouTubeReplayer',1);this.dbreq.onsuccess=(e)=>{this.db=e.target.result;this.isOpen=!0;this.runWaitingFunction();};this.dbreq.onerror=(e)=>0;this.dbreq.onupgradeneeded=(evt)=>{var db=evt.target.result;if(!db.objectStoreNames.contains('replayRange'))db.createObjectStore('replayRange',{keyPath:'videoID'});};}else if(this.isOpen) this.runWaitingFunction();this.isReqOpen=!0;},runWaitingFunction:function(){let f;while(f=this.waitingFunctionList.shift())f.constructor==Function&&f();},getInfoByVideoID:function(vid,cb){this.waitingFunctionList.push(()=>{this.db.transaction(['replayRange']).objectStore('replayRange').get(vid).onsuccess=(evt)=>{let r=evt.target.result;!!r&&!r.curMode&&(r.curMode=!!r.autoPlay?this.parent.mode.loop:this.parent.mode.stop)&&delete r.autoPlay;!!cb&&cb.constructor==Function&&cb(r);};});this.openDB();},setInfo:function(vid,data,cb){data.videoID=vid;this.waitingFunctionList.push(()=>{this.db.transaction(['replayRange'],'readwrite').objectStore('replayRange').put(data).onsuccess=(evt)=>!!cb&&cb.constructor==Function&&cb(evt.target.result);});this.openDB();},init:function(){!this.isReqOpen&&this.openDB();}},reset:{ReplayerTimer:function(){this.parent.rmTimer()},Duration:function(){this.parent.duration={start:null,end:null}},Player:function(){this.parent.player=$('#movie_player');$('video').loop=!1;},main:function(){if(!this.changing){this.changing=!0;for(var x in this)this[x].constructor==Function&&this[x]();this.changing=!1;}}},unload:{SaveRecord:function(){if(this.parent.duration.start!=null)this.parent.IndexedDB.setInfo(this.parent.init.curVideoID,{start:this.parent.duration.start,end:this.parent.duration.end,curMode:this.parent.curMode},null)},main:function(){if(!this.changing){this.changing=!0;for(var x in this)this[x].constructor==Function&&this[x]();this.changing=!1;}}},init:{SetUnloadHandler:function(){if(!this.unloadHandler){window.addEventListener('beforeunload', ()=>this.parent.unload.main());this.unloadHandler=!0;}this.state.unloadHandler=!!this.unloadHandler;},ReplayerLayout:function(){let e=$('#watch8-secondary-actions');if(!(this.state.replayer=!!this.state.replayer)&&!!e){let p=this.parent,t=p.text,f=t.TooltipFormat;e.innerHTML='<span><input id=replayerTimerFrom size=6 placeholder=\"'+t.PlaceHolderFrom+'\" title=\"'+t.TooltipFrom+' - '+f+'\" class=\"yt-uix-tooltip yt-uix-button yt-uix-button-text yt-uix-button-opacity\" style=\"text-align:right;font-size:larger;font-weight:bold\"><button id=replayerA title=\"'+t.TooltipFromButton+'\" class=\"yt-uix-tooltip yt-uix-button yt-uix-button-text yt-uix-button-opacity\" style=\"text-align:center;font-size:larger;font-weight:bold\">'+t.ButtonFrom+'</button><button class=\"yt-uix-button yt-uix-button-text yt-uix-button-opacity\" style=\"font-size:larger;font-weight:bold\">-</button><button id=replayerB title=\"'+t.TooltipToButton+'\" class=\"yt-uix-tooltip yt-uix-button yt-uix-button-text yt-uix-button-opacity\" style=\"text-align:center;font-size:larger;font-weight:bold\">'+t.ButtonTo+'</button><input id=replayerTimerTo size=6 placeholder=\"'+t.PlaceHolderTo+'\" title=\"'+t.TooltipTo+' - '+f+'\" class=\"yt-uix-tooltip yt-uix-button yt-uix-button-text yt-uix-button-opacity\" style=\"text-align:left;font-size:larger;font-weight:bold\"><button id=replayToggle title=\"'+t.TooltipStopToLoop+'\" class=\"yt-uix-tooltip yt-uix-button yt-uix-button-text yt-uix-button-opacity\" style=\"text-align:center;font-size:large;font-weight:bold;width:50px\">'+t.Stop+'</button></span>'+e.innerHTML;$('#watch8-secondary-actions #replayerTimerFrom').addEventListener('keyup',()=>window.event.keyCode==13&&p.toggle(p.curMode!=p.mode.stop?p.curMode:p.mode.crop),!1);$('#watch8-secondary-actions #replayerTimerTo').addEventListener('keyup',()=>window.event.keyCode==13&&p.toggle(p.curMode!=p.mode.stop?p.curMode:p.mode.crop),!1);$('#watch8-secondary-actions #replayerA').addEventListener('click',()=>p.setA(),!1);$('#watch8-secondary-actions #replayerB').addEventListener('click',()=>p.setB(),!1);$('#watch8-secondary-actions #replayToggle').addEventListener('click',()=>p.toggle(),!1);this.state.replayer=!0;}},ChangeYouTubeLayout:function(){if(this.state.replayer)if(!(this.state.likeDislike=!!this.state.likeDislike)){let e,eL;e=$('#watch-like-dislike-buttons');eL=!!e&&e.querySelectorAll('.yt-uix-button-content')||[];for(let i=0;i<eL.length;i++)this.state.likeDislike=!!eL[i]&&!!eL[i].parentNode.removeChild(eL[i]);eL=!!e&&e.querySelectorAll('button')||[];for(let i=0;i<eL.length;i++)if(!!eL[i]){eL[i].style.padding='0 5px';eL[i].querySelector('span').style.margin='0';eL[i].querySelector('.yt-uix-button-icon').style.margin='0';}this.state.likeDislike=!0;}},ChangeQuanlity:function(){if(!this.state.playerQuality)this.parent.player.setPlaybackQuality(this.parent.player.getAvailableQualityLevels()[0]);this.state.playerQuality=(this.parent.player.getPlaybackQuality()==this.parent.player.getAvailableQualityLevels()[0]);},LoadInfoAndRun:function(){if(this.state.replayer&&!(this.state.IDBOpenReq=!!this.state.IDBOpenReq)){this.parent.IndexedDB.init();this.state.IDBOpenReq=this.parent.IndexedDB.isReqOpen;this.parent.IndexedDB.getInfoByVideoID(yt.config_.VIDEO_ID,(info)=>{if(!!info){this.parent.duration.start=info.start;this.parent.duration.end=info.end;this.parent.curMode=info.curMode;this.parent.showRepeatRange();this.parent.toggle(info.curMode);}});}},curVideoID:'',state:{},preInit:function(){Replayer.reset.parent=Replayer.unload.parent=Replayer.IndexedDB.parent=Replayer.init.parent=Replayer;},main:function(){if(!this.changing){this.changing=!0;if(!yt.config_.VIDEO_ID)this.curVideoID=null;else{let isNeedReset;if(isNeedReset=(this.curVideoID!=yt.config_.VIDEO_ID)){!!this.curVideoID&&this.parent.unload.main();this.parent.reset.main();}for(let x in this.state)if(isNeedReset=(isNeedReset||!this.state[x]))break;if(isNeedReset){this.curVideoID=yt.config_.VIDEO_ID;for(let x in this)this[x].constructor==Function&&this[x]();let result=!0;for(let x in this.state)result&=this.state[x];if(result)this.state={};else setTimeout(()=>this.main());}}this.changing=!1;}}}};if(!('$' in window)){$=function(a){return document.querySelector(a)}};Replayer.init.preInit();setTimeout(()=>Replayer.init.main());document.body.addEventListener('load',()=>Replayer.init.main(),true)";
	document.head.appendChild(script);
}
